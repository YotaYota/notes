<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>DynamoDB - Notes</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../network/network.html"><strong aria-hidden="true">1.</strong> Network</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network/letsencrypy.html"><strong aria-hidden="true">1.1.</strong> letsencrypt</a></li><li class="chapter-item expanded "><a href="../network/netconf_yang.html"><strong aria-hidden="true">1.2.</strong> NETConf YANG</a></li><li class="chapter-item expanded "><a href="../network/tls.html"><strong aria-hidden="true">1.3.</strong> SSL/TLS</a></li></ol></li><li class="chapter-item expanded "><a href="../js/js.html"><strong aria-hidden="true">2.</strong> Javascript</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../js/angular.html"><strong aria-hidden="true">2.1.</strong> angular</a></li><li class="chapter-item expanded "><a href="../js/jest.html"><strong aria-hidden="true">2.2.</strong> jest</a></li><li class="chapter-item expanded "><a href="../js/js.html"><strong aria-hidden="true">2.3.</strong> js</a></li><li class="chapter-item expanded "><a href="../js/react.html"><strong aria-hidden="true">2.4.</strong> react</a></li></ol></li><li class="chapter-item expanded "><a href="../python/main.html"><strong aria-hidden="true">3.</strong> Python</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../python/dist.html"><strong aria-hidden="true">3.1.</strong> dist</a></li></ol></li><li class="chapter-item expanded "><a href="../aws/aws.html"><strong aria-hidden="true">4.</strong> AWS</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../aws/api_gateway.html"><strong aria-hidden="true">4.1.</strong> API Gateway</a></li><li class="chapter-item expanded "><a href="../aws/ccp.html"><strong aria-hidden="true">4.2.</strong> CCP</a></li><li class="chapter-item expanded "><a href="../aws/cli.html"><strong aria-hidden="true">4.3.</strong> CLI</a></li><li class="chapter-item expanded "><a href="../aws/cognito.html"><strong aria-hidden="true">4.4.</strong> Cognito</a></li><li class="chapter-item expanded "><a href="../aws/dynamodb.html" class="active"><strong aria-hidden="true">4.5.</strong> DynamoDB</a></li><li class="chapter-item expanded "><a href="../aws/static_website.html"><strong aria-hidden="true">4.6.</strong> Static Website</a></li><li class="chapter-item expanded "><a href="../aws/iam.html"><strong aria-hidden="true">4.7.</strong> IAM</a></li><li class="chapter-item expanded "><a href="../aws/lambda.html"><strong aria-hidden="true">4.8.</strong> Lambda</a></li></ol></li><li class="chapter-item expanded "><a href="../linux/linux.html"><strong aria-hidden="true">5.</strong> Linux - Systemd</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../linux/systemd.html"><strong aria-hidden="true">5.1.</strong> systemd</a></li><li class="chapter-item expanded "><a href="../linux/users-groups.html"><strong aria-hidden="true">5.2.</strong> users-groups</a></li><li class="chapter-item expanded "><a href="../linux/deb_pkg.html"><strong aria-hidden="true">5.3.</strong> Debian Packaging</a></li><li class="chapter-item expanded "><a href="../linux/essential_tools.html"><strong aria-hidden="true">5.4.</strong> Essential Tools</a></li><li class="chapter-item expanded "><a href="../linux/iproute2.html"><strong aria-hidden="true">5.5.</strong> IProute2</a></li><li class="chapter-item expanded "><a href="../linux/wireguard.html"><strong aria-hidden="true">5.6.</strong> Wireguard</a></li><li class="chapter-item expanded "><a href="../linux/kvm.html"><strong aria-hidden="true">5.7.</strong> KVM</a></li><li class="chapter-item expanded "><a href="../linux/logging.html"><strong aria-hidden="true">5.8.</strong> Logging</a></li><li class="chapter-item expanded "><a href="../linux/lutris.html"><strong aria-hidden="true">5.9.</strong> Lutris</a></li><li class="chapter-item expanded "><a href="../linux/nftables.html"><strong aria-hidden="true">5.10.</strong> nftables</a></li><li class="chapter-item expanded "><a href="../linux/screen.html"><strong aria-hidden="true">5.11.</strong> screen</a></li><li class="chapter-item expanded "><a href="../linux/wine.html"><strong aria-hidden="true">5.12.</strong> Wine</a></li></ol></li><li class="chapter-item expanded "><a href="../rust/rust.html"><strong aria-hidden="true">6.</strong> rust</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rust/rust_web_app.html"><strong aria-hidden="true">6.1.</strong> Web App</a></li><li class="chapter-item expanded "><a href="../rust/bevy.html"><strong aria-hidden="true">6.2.</strong> Bevy</a></li></ol></li><li class="chapter-item expanded "><a href="../gpg.html"><strong aria-hidden="true">7.</strong> gpg</a></li><li class="chapter-item expanded "><a href="../ssh.html"><strong aria-hidden="true">8.</strong> ssh</a></li><li class="chapter-item expanded "><a href="../yubikey.html"><strong aria-hidden="true">9.</strong> yubikey</a></li><li class="chapter-item expanded "><a href="../git.html"><strong aria-hidden="true">10.</strong> git</a></li><li class="chapter-item expanded "><a href="../neovim.html"><strong aria-hidden="true">11.</strong> neovim</a></li><li class="chapter-item expanded "><a href="../compdocs.html"><strong aria-hidden="true">12.</strong> compdocs</a></li><li class="chapter-item expanded "><a href="../cpp.html"><strong aria-hidden="true">13.</strong> C++</a></li><li class="chapter-item expanded "><a href="../docker.html"><strong aria-hidden="true">14.</strong> Docker</a></li><li class="chapter-item expanded "><a href="../flatbuffers.html"><strong aria-hidden="true">15.</strong> flatbuffers</a></li><li class="chapter-item expanded "><a href="../protbuf.html"><strong aria-hidden="true">16.</strong> protbuf</a></li><li class="chapter-item expanded "><a href="../geojson.html"><strong aria-hidden="true">17.</strong> geojson</a></li><li class="chapter-item expanded "><a href="../java.html"><strong aria-hidden="true">18.</strong> Java</a></li><li class="chapter-item expanded "><a href="../jwt.html"><strong aria-hidden="true">19.</strong> JWT</a></li><li class="chapter-item expanded "><a href="../kubernetes.html"><strong aria-hidden="true">20.</strong> Kubernetes</a></li><li class="chapter-item expanded "><a href="../patterns.html"><strong aria-hidden="true">21.</strong> Patterns</a></li><li class="chapter-item expanded "><a href="../puppet.html"><strong aria-hidden="true">22.</strong> puppet</a></li><li class="chapter-item expanded "><a href="../raid.html"><strong aria-hidden="true">23.</strong> RAID</a></li><li class="chapter-item expanded "><a href="../scrum.html"><strong aria-hidden="true">24.</strong> SCRUM</a></li><li class="chapter-item expanded "><a href="../serverless-framework.html"><strong aria-hidden="true">25.</strong> serverless-framework</a></li><li class="chapter-item expanded "><a href="../spring.html"><strong aria-hidden="true">26.</strong> Spring</a></li><li class="chapter-item expanded "><a href="../sql.html"><strong aria-hidden="true">27.</strong> SQL</a></li><li class="chapter-item expanded "><a href="../terraform.html"><strong aria-hidden="true">28.</strong> Terraform</a></li><li class="chapter-item expanded "><a href="../clean_architecture.html"><strong aria-hidden="true">29.</strong> Clean Architecture</a></li><li class="chapter-item expanded "><a href="../vocabulary.html"><strong aria-hidden="true">30.</strong> Vocabulary</a></li><li class="chapter-item expanded "><a href="../work_strategy.html"><strong aria-hidden="true">31.</strong> Work Stratrgy</a></li><li class="chapter-item expanded "><a href="../project.html"><strong aria-hidden="true">32.</strong> Project</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="dynamodb"><a class="header" href="#dynamodb">DynamoDB</a></h1>
<ul>
<li>NoSQL</li>
<li>key-value</li>
</ul>
<p>Supports <code>AWS::Backup</code></p>
<h2 id="cap-theorem"><a class="header" href="#cap-theorem">CAP Theorem</a></h2>
<p>CAP</p>
<ul>
<li>Consistency (same across all replication points before returning result)
<ul>
<li>DynomDB supports <em>strongly</em> or <em>eventually</em> consistent reads</li>
</ul>
</li>
<li>Availability</li>
<li>Partition Tolerance</li>
</ul>
<p>Of these 3, we can only have 2 at the same time.</p>
<h2 id="nosql"><a class="header" href="#nosql">NoSQL</a></h2>
<p>No cross table relationships</p>
<p>3 main types:</p>
<ul>
<li>Key-value (DynamoDB)</li>
<li>Column-based (eg Cassandra)</li>
<li>Document-based (eg MongoDB)</li>
</ul>
<h2 id="design"><a class="header" href="#design">Design</a></h2>
<h3 id="queries-first"><a class="header" href="#queries-first">Queries first</a></h3>
<p>Design of DynamoDB tables requires query patterns to be evaluated <em>first</em>.</p>
<p><strong>Note</strong>: DynamoDB does not support joins.</p>
<p>In order to limit the number of round trips, the data must be ordered in a way
to minimize the number of calls to the database.</p>
<h3 id="partitioning"><a class="header" href="#partitioning">Partitioning</a></h3>
<p>DynamoDB is designed to partition the underlying data into different storages.</p>
<p>The partitioning is guided by the partition key, therefore it is very important
to design the partition key so that the data is distributed equally. Otherwise
you can get hot partitions that impede the performance.</p>
<hr />
<h2 id="table"><a class="header" href="#table">Table</a></h2>
<p>A collection of 0 or more items.
Items can be queried through their keys.
Items are made up of their attributes</p>
<p><code>primary key</code> (or <code>partition key</code>) is mandatory.
<code>sort key</code> is optional.</p>
<p><strong>Note</strong>: Primary key or sort key <strong>can</strong> be duplicated, but <strong>not both</strong> at the same time.</p>
<p>Extra keys are attributes.</p>
<p>By default queries are only supported on partition and sort key. To support
queries on other keys, secondary indexes are needed.</p>
<h3 id="item-types"><a class="header" href="#item-types">Item types</a></h3>
<ul>
<li><code>S</code> – String</li>
<li><code>N</code> – Number</li>
<li><code>B</code> – Binary</li>
<li><code>BOOL</code> – Boolean</li>
<li><code>NULL</code> – Null</li>
<li><code>M</code> – Map</li>
<li><code>L</code> – List</li>
<li><code>SS</code> – String Set</li>
<li><code>NS</code> – Number Set</li>
<li><code>BS</code> – Binary Set</li>
</ul>
<h2 id="item"><a class="header" href="#item">Item</a></h2>
<ul>
<li>Max size is 400 kB</li>
<li><code>partition key</code> min length is 1 byte, max length 2048 bytes</li>
<li><code>sort key</code> min length is 1 byte, max length 1024 bytes</li>
</ul>
<p>Items need not have the same number of attributes.</p>
<h2 id="query"><a class="header" href="#query">Query</a></h2>
<p>Find items based on</p>
<ul>
<li><code>partition key</code> value alone, or</li>
<li><code>partition key</code> value and <code>sort key</code> value in cases where sort key is defined</li>
</ul>
<h2 id="scan"><a class="header" href="#scan">Scan</a></h2>
<pre><code>aws dynamodb scan --table-name &lt;TABLE&gt;
</code></pre>
<p>Retrieves all items in a table. More costly than a query.</p>
<p>Scans can be supplied with the <code>--max-items &lt;NUMBER&gt;</code> flag.</p>
<p><strong>Note</strong>: filters will happen <em>after</em> a scan is complete, so it will <strong>not</strong>
make the scan more efficient.</p>
<p><strong>Note</strong>: Scans only returns data up to a limit (by default 1MB).</p>
<p><strong>Note</strong>: Scans are by default paginated.</p>
<h2 id="secondary-index"><a class="header" href="#secondary-index">Secondary Index</a></h2>
<p>Basically creates a copy of the table with an alternate key schema.</p>
<ul>
<li><em>Local secondary index</em>, allows to create an alternate sort key</li>
<li><em>Global secondary index</em>, allows to create an alternate partition and sort key</li>
</ul>
<h2 id="batchgetitem--batchwriteitem"><a class="header" href="#batchgetitem--batchwriteitem"><code>BatchGetItem</code> &amp; <code>BatchWriteItem</code></a></h2>
<p>Each write in <code>BatchWriteItem</code> is atomic, but the command as whole is <strong>not</strong>.</p>
<p><code>BatchGetItem</code> is <em>eventually consistent</em> by default.</p>
<p><strong>Note</strong>: You will be provided with a list of unprocessed items.</p>
<h2 id="aws-cli"><a class="header" href="#aws-cli">AWS CLI</a></h2>
<pre><code>aws dynamodb list-tables
aws dynamodb put-item --table-name &lt;TABLE&gt; --item file://&lt;JSON FILE&gt;
aws dynamodb delete-item --table-name &lt;TABLE&gt; --key file://&lt;JSON FILE&gt;
aws dynamodb query --table-name &lt;TABLE&gt; --key-condition-expression ... --expression-attribute-values file://&lt;JSON FILE&gt;
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../aws/cognito.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../aws/static_website.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../aws/cognito.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../aws/static_website.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
